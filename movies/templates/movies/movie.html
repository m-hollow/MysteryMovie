{% extends 'movies/base.html' %}
{% load bootstrap4 %}
{% load static %}

{% block title %}
<title>{{ movie.name }}</title>
{% endblock title %}

{% block page_header %}
  <h2>{{ movie.name }}</h2>
{% endblock page_header %}

{% block content %}


{% if not user_movie_details %}

<p>Watched on <b> {{ movie.date_watched|date:'M d, Y'}}</b></p>
<p>Please update your details for <b>{{ movie.name }}</b>:</p>

<form method="post" action="{% url 'movies:add_details' movie.pk %}" class="form">
  
  {% csrf_token %}
  {% bootstrap_form form %}

  <br>
  <button class="btn btn-secondary" type="submit">Submit Details</button>

</form>

{% else %}

<p>Watched on <b> {{ movie.date_watched|date:'M d, Y'}}</b><br>
  {% if user_movie_details.is_user_movie %}
    This movie was <i>your</i> choice, oh my.</p>
  {% else %}
    This movie was chosen by another user, phew. </p>
  {% endif %}

<!-- note: get_ and _display are prepended / appended to the actual field names below, because
    this is how you display the 'choices' option when the Model field has choices= defined for
    a field. -->

<p class="border-bottom pb-2 mb-2">Your Details</p>

  <ul class="pl-0" style="list-style-type:none">
      <li>Seen Previously: <span class="float-right">{{ user_movie_details.get_seen_previously_display }}</span></li>
      <li>Heard of Before: <span class="float-right">{{ user_movie_details.get_heard_of_display }}</span></li>
    {% if not user_movie_details.is_user_movie %}
      <li>Your User Guess: <span class="float-right">{{ user_movie_details.user_guess.username }}</span></li>
    {% endif %}
      <br>
      <li>Deep Hurting Score: <span class="float-right">{{ user_movie_details.get_star_rating_display }}</span></li>

<!--     {% if user_movie_details.comments %}
      <li>Your Comments: <span class="float-right">{{ user_movie_details.comments }}</span></li>
    {% endif %} -->
  
  </ul>

  <br>

  <p><span class="float-right"><a href="{% url 'movies:update_details' user_movie_details.pk %}"><b>Edit Details</b></a></span></p>


<!-- do a bool check here to see if the round that this movie belongs to is complete or not, if it is, display the results -->

    {% if game_round.round_completed %}
        <br>
        <br>
        <div class="border-bottom">
          <h5>Movie Details - Round Completed</h5>
        </div>
        <br>
        <ul class="pl-0" style="list-style-type:none">
            <li>This movie was chosen by:<span class="float-right"><b>{{ user_that_chose_movie.username }}</b></span></li>
            <li>The average rating for this movie was:<span class="float-right"><b>{{ movie_avg_rating }}</b></span></li>

            <li>Users who correctly blamed <b>{{ user_that_chose_movie.username }}</b>:<span class="float-right">...</span></li>
            <br>
            <li># of Users who had already seen it:</li>
            <li># of Users who had never heard of it:</li>
        </ul>


    {% else %}
<!--     <br>
    <p>Your results for this movie will be posted after the Round is complete.</p> -->
    {% endif %}

<br>
<span class="float-right"><a href="{% url 'movies:index' %}"><b>Go Back</b></span></a></p>

{% endif %}


{% endblock content %}
